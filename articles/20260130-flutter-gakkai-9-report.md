---
title: "第9回 Flutter Gakkai オフライン参加レポ"
emoji: "🎓"
type: "tech"
topics: ["flutter"]
published: true
---

## はじめに

2026年1月30日に開催された[第9回FlutterGakkai](https://x.com/FlutterGakkai)にオフラインで参加しました！
本記事では、各発表の内容を個人的な要点でレポートにしてみます。（自分で後から見返したいので...）

---

## maestro mcpでFlutterアプリでもフィードバックループを回そう

### 背景と課題

AI駆動開発の効率化が進む中、開発の9割をAIエージェントに任せられるようになってきた一方で、**人間による動作確認がボトルネック**になっていたとのこと。そこで、AI自身にUI検証を行わせる仕組みの構築がテーマでした！

### 3つのMCPツールの比較

| ツール | 特徴 |
|--------|------|
| **Maestro MCP** | E2EテストツールのMCP版。iOS/Androidに対応。既存のテストシナリオを再利用可能。 |
| **Mobile MCP** | NPXコマンドで常に最新版を利用可能。ネイティブアプリ全般に利用できる汎用性の高いツール。 |
| **Marionette MCP** | Flutterの内部仕組み（VMサービスプロトコル）を利用。デスクトップを含む全プラットフォームに対応。 |

### 📱 外部アプローチ（Maestro / Mobile MCP）

> OSのアクセシビリティツリー経由で画面を把握。Semantics の付与が検証精度の鍵。

OSの「スクリーンリーダー用の情報」で画面の要素を見る方式。Flutterはデフォルトだとラベルが足りず、AIがボタンや入力欄を認識できないことがあるので、**Semantics で明示的にラベルを付けておく**と検証しやすくなる、という話でした。

### ⚙️ 内部アプローチ（Marionette MCP）

> Flutter VM の内部ツリーを直接参照。認証トークン無効化が運用の鍵。

Flutterの内部（VM）を直接触る方式。普段は認証トークンが必要だけど、AIが自動でURLを探して操作するときは邪魔になるので、**トークンを無効にしたデバッグビルド**で運用するのがコツ。TextField などは **ValueKey** で識別すると扱いやすい、とのことでした。

### 共通の運用ノウハウ

- **スキルのカスタマイズ**：AIに対して、アプリ固有の階層構造や、ビルド時の注意点（`dart-define` の設定等）を **「スキル」として記述し、AIにはまりポイントを学習させること** が実用上の重要事項です。
- **時間的制約の理解**：AIによる操作は人間より時間がかかる場合があるため、速度よりも **「人間が介在するタイミングを減らすこと」** に主眼を置くべきとされています。

---

## StudyplusにおけるFlutterアプリのApple Watch対応事例

### 開発背景

スマホによる誘惑を避け、学習に集中したいというユーザーニーズに応えるため、学習記録機能を**Apple Watch**へ展開

### 技術構成

- **Flutter ↔ iOS**：Method Channel（Pigeon）
- **iOS ↔ watchOS**：WCSession を用いてデータを連携

### 実装の困難と解決

- **ビルドエラー**：watchOSターゲット追加時の循環参照やフレームワークの組み込みミスなど、Xcode特有の構成エラーへの対処が必要でした
- **デバッグ**：iOSとwatchOSのログを同時に確認するため、macOSの**「コンソール」アプリ**を活用し、両デバイスの出力を追跡

### 設計指針

画面サイズを考慮し、最も重要なアクション（教材選択と記録）に機能を絞り込むのを意識

---

## Flutter×BLEでプロフィール交換機能を作った話

### 機能概要

端末同士を近づけるだけで、名刺交換のようにデータをやり取りする機能を**BLE**で実装したそうです！

### 通信ロジック

- **Central / Peripheral の役割**：各端末に両方の役割を持たせ、サービスUUIDによるフィルタリングで対象デバイスを特定
- **距離判定**：電波強度（RSSI）の平均値や最大値を取得し、至近距離の端末のみと接続するよう制御

### 課題解決

- Android特有の**MTU（データサイズ）拡張設定**の必要性
- 複数端末が近くにある際の**セッションIDによる優先順位付け**（役割分担）を実装

---

## そのインタラクション、Flutterでどう作るか

### GestureDetectorの深掘り

`onTap`（指を離した瞬間に反応）だけでなく、2本指スワイプやドラッグなど、以下の活用が解説されていました！

- **2本指スワイプ**の検知（`onScale`）
- **ドラッグ操作**（`onPan`）の活用

### スプリングシミュレーション

最近導入された **Duration & Bounce** を使うと、iOSっぽい減速やバネの動きを反映した自然なアニメーションが実現できるそうです！

### 最新のウィジェット

- **TapRegion**：ポップオーバーの外側タップを検知して閉じる処理が簡単に書ける！
- **ClipRSuperEllipse**：パッケージなしでiOS風の滑らかな角丸が作れる！

---

## Flutterで実現させる、オンライン診療の着信体験

### 開発の狙い

URLクリックや入室許可の操作を排除し、電話のように**「着信」から診察を開始**できるシームレスな体験を目指している

### プッシュ通知の最適化

- **サイレントプッシュの限界**：重要な機能のトリガーとして信頼性が低いため、
  - **iOS**：VoIP Push（PushKit / CallKit）を採用
  - **Android**：高優先度FCMを使用
- **データ連携**：限定的な起動状態（Swiftレイヤー）で受け取ったペイロードを、Flutterエンジン起動後に **Method Channel** 経由で取得する構成

### OS制約への対応

Androidにおける**全画面インテント通知の権限許可**の重要性と、UIでユーザーを誘導する必要性が強調されていました！

---

## Codemagicの紹介

- Flutter向けの**GUI設定が充実**していて、初心者でも使いやすい！
- **無料枠（月500分）**があるので個人開発におすすめ！

---

## 感想

登壇者の皆さんの話と内容がどれも面白かったです！
それぞれがサービスが違うので全然違った技術や内容で勉強になりました。

- **MCP**  
ちょうど、FlutterインテグレーションテストでテストコードAIに書かせてたりしたので、
業務で使ってみたい。開発効率化の観点で試した方が良さそう。
最初からゴリゴリバイブコーディングで回す系の開発だったらこの方式で回せそう。
- **Apple Watch＆Codemagic**  
個人開発で検討したい。地図系アプリを作っているので、Apple Watch版にも挑戦してみたい（ネイティブ周り意外といけそうと思えた）。Codemagicは個人でも無料枠で使えるのでどこかで導入したい。
- **BLE・電話（着信）・UIの深掘り**  
Bluetooth、プッシュ／VoIP、GestureDetectorなどUIの深掘りは、今後携わるプロダクト次第では必要になりそうなのでいい学びになった！

登壇者の皆様ありがとうございました！

---



